
<div id="comments-popup" data-controller="comments--popup comments--list comments--form comments--presence comments--mention-menu comments--topics" class="popup-box"
     data-loading-text="<%= t('app.loading') %>"
     data-delete-confirm-text="<%= t("comments.delete_confirm") %>"
     data-update-comment-text="<%= t('comments.update_comment') %>"
     data-convert-confirm-text="<%= t('comments.convert_confirm') %>"
     data-copy-link-success-text="<%= t('comments.copy_link_success') %>"
     data-copy-link-error-text="<%= t('comments.copy_link_error') %>"
     data-approve-success-text="<%= t('comments.approve_success') %>"
     data-approve-error-text="<%= t('comments.approve_error') %>"
     data-action-update-success-text="<%= t('comments.action_update_success') %>"
     data-action-update-error-text="<%= t('comments.action_update_error') %>"
     data-attachment-delete-error-text="<%= t('comments.attachment_delete_error') %>"
     data-search-empty-text="<%= t('comments.search_empty_prompt') %>"
     data-speech-unavailable-text="<%= t('comments.speech_unavailable') %>"
     data-voice-start-text="<%= t('comments.voice_button') %>"
     data-voice-stop-text="<%= t('comments.voice_stop') %>"
     data-move-no-selection-text="<%= t('comments.move_no_selection') %>"
     data-move-error-text="<%= t('comments.move_error') %>">
  <div class="resize-handle resize-handle-left" data-comments--popup-target="leftHandle"></div>
  <div class="resize-handle resize-handle-right" data-comments--popup-target="rightHandle"></div>
  <button id="close-comments-btn" data-comments--popup-target="closeButton" class="popup-close-btn">&times;</button>
  <h3 id="comments-popup-title" data-comments--popup-target="title"><%= t('comments.comments') %></h3>
  <div id="comment-participants" data-comments--presence-target="participants" data-comments--mention-menu-target="participants"></div>
  <div id="comment-topics" data-comments--topics-target="list" class="comment-topics-list"
       data-confirm-delete-text="<%= t('topics.delete_confirm') %>"
       data-new-topic-placeholder="<%= t('topics.new_placeholder') %>"></div>
  <%= render UserMentionMenuComponent.new(menu_id: 'mention-menu') %>
  <div id="comments-list" data-comments--popup-target="list" data-comments--list-target="list"><%= t('app.loading') %></div>
  <div id="typing-indicator" data-comments--presence-target="typingIndicator"></div>
  <form id="new-comment-form" data-comments--popup-target="form" data-comments--form-target="form" style="display:none;">
    <textarea class="shared-input-surface" name="comment[content]" data-comments--form-target="textarea" data-comments--presence-target="textarea" data-comments--mention-menu-target="textarea" rows="2" enterkeyhint="send"></textarea>
    <div class="comment-bottom">
    <input type="file" id="comment-images" name="comment[images][]" accept="image/*" multiple data-comments--form-target="imageInput" style="display:none;" />
    <label style="height: 22px"><input type="checkbox" id="comment-private" data-comments--form-target="privateCheckbox" data-comments--presence-target="privateCheckbox" name="comment[private]" /> <%= t('comments.private') %></label>
    <div class="comment-actions">
    <button class="creative-action-btn" id="attach-image-btn" data-comments--form-target="imageButton" type="button"><%= t('comments.image_button') %></button>
    <button class="creative-action-btn" id="voice-comments-btn" data-comments--form-target="voiceButton" type="button" data-voice-state="idle"><%= t('comments.voice_button') %></button>
    <button class="creative-action-btn" id="search-comments-btn" data-comments--form-target="searchButton" type="button"><%= t('comments.search_button') %></button>
    <button class="creative-action-btn" id="move-comments-btn" data-comments--form-target="moveButton" type="button" disabled><%= t('comments.move_button') %></button>
    <button class="creative-action-btn" id="cancel-edit-btn" data-comments--form-target="cancel" type="button" style="display:none;"><%= t('app.cancel') %></button>
    <button class="creative-action-btn" type="submit" data-comments--form-target="submit"><%= svg_tag 'send.svg', class: 'send-icon' %></button>
    </div>
    <div class="comment-attachment-list" data-comments--form-target="attachmentList" aria-live="polite"></div>
  </form>
</div>
