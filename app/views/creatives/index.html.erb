<div class="creative-actions-row">
  <% if @parent_creative&.parent_id.present? %>
    <%= link_to t('.up'), creative_path(@parent_creative.parent_id), class: "back-link" %>
  <% elsif @parent_creative.present? %>
    <%= link_to t('.up'), creatives_path, class: "up-link" %>
  <% end %>
  
  <%= link_to t('.new_creative'), new_creative_path if authenticated? and not params[:id] %>
  <% if authenticated? and @parent_creative %>
    <%= link_to t('.new_sub_creative'), @parent_creative&.id ? new_creative_path(parent_id: @parent_creative.id) : new_creative_path %>
    <%= link_to t('.edit'), edit_creative_path(@parent_creative) %>
    <%= button_to t('.delete'), @parent_creative, method: :delete, data: { turbo_confirm: t('.are_you_sure') }, class: "danger-link" %>
  <% end %>
  <button id="import-markdown-btn" class="import-btn"><%= t('.import_markdown') %></button>
</div>
<div id="import-markdown-area" data-parent-creative-id="<%= @parent_creative&.id %>" style="display:none; margin: 1em 0;">
  <div id="import-markdown-dropzone"
    style="border:2px dashed #888;padding:2em;text-align:center;cursor:pointer;background:#fafafa;"
    data-uploading="<%= t('.import_uploading') %>"
    data-success="<%= t('.import_success') %>"
    data-failed="<%= t('.import_failed') %>"
    data-only-markdown="<%= t('.only_markdown') %>">
    <%= t('.drop_or_click_markdown') %>
    <input type="file" id="import-markdown-input" accept=".md" style="display:none;" />
    <div id="import-markdown-progress" style="margin-top:1em;color:#0074d9;display:none;"></div>
  </div>
</div>

<%#= TODO: remove this later completely recalculate progress you need to remove route, and controller also %>
<%#= button_to t('.recalculate_progress'), recalculate_progress_creatives_path, method: :post, form: { data: { turbo_confirm: t('.recalculate_all_parent_progress') } } if authenticated? %>

<% if @parent_creative %>
  <div class="creative-row">
    <h1 class="page-title"><%= @parent_creative.description %></h1>
    <h1>
      <%= render_creative_progress(@parent_creative) %>
    </h1>
  </div>
<% else %>
  <div class="creative-row">
    <h1 class="page-title"><%= t('.creatives') %></h1>
  </div>
<% end %>

<div id="creatives">
  <% creatives_for_tree = @creatives.where(parent_id: params[:id] || nil) %>
  <% if creatives_for_tree.exists? %>
    <%= render_creative_tree(creatives_for_tree) %>
  <% else %>
    <p style="text-align: center;"><%= params[:id] ? t('.no_sub_creatives') : t('.no_creatives') %></p>
  <% end %>
</div>

<%= javascript_include_tag 'creatives_drag_drop', defer: true %>
<%= javascript_include_tag 'creatives_import' %>
